window.ycPay=null,window.setupYouCanPayForm=(()=>{try{null==window.ycPay&&(window.ycPay=new YCPay(youcan_pay_script_vars.key,{locale:youcan_pay_script_vars.locale}),1===parseInt(youcan_pay_script_vars.is_test_mode)&&window.ycPay.setSandboxMode(!0)),window.ycPay.renderAvailableGateways("#payment-card","default")}catch(e){console.error(e)}}),jQuery(function(e){var o={credit_card:1,cash_plus:2},r=e('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout"></div>');function a(o,r){e("html, body").animate({scrollTop:e(".woocommerce").offset().top},400),e(".blockOverlay").remove(),e(".woocommerce-notices-wrapper").remove(),o.removeClass("processing"),null!=r&&(clearInterval(r),e(".woocommerce-NoticeGroup-checkout").remove())}function c(e,c){if(void 0!==c.token_transaction){var n=null;try{n=setInterval(function(){jQuery("#ycp-3ds-modal").length>0&&a(e,n)},500),window.ycPay.pay(c.token_transaction).then(function(r){if(a(e,n),void 0!==c.redirect){let e=new URL(c.redirect);e.searchParams.set("transaction_id",r),o.cash_plus===parseInt(window.ycPay.selectedGateway)&&e.searchParams.set("gateway","cash_plus"),window.location.href=e.href}}).catch(function(o){a(e,n),(null===o||o.length<1)&&(o=youcan_pay_script_vars.errors.connexion_api);let c=r.clone();c.append('<ul class="woocommerce-error" role="alert"></ul>'),c.find("ul").append("<li>"+o+"</li>"),e.prepend(c)})}catch(o){a(e,n),console.error(o)}}a(e)}function n(o){e.ajax({method:"POST",url:youcan_pay_script_vars.checkout_url,data:o.serialize(),dataType:"json",beforeSend:function(){try{e(".woocommerce-NoticeGroup-checkout").remove(),o.addClass("processing"),o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}catch(e){console.error(e)}}}).done(function(e){(function(e,o){if(void 0!==o.messages){let a=r.clone();return a.append(o.messages),e.prepend(a),!0}return!1})(o,e)||c(o,e)}).fail(function(e){}).always(function(e){void 0===e.token_transaction&&a(o)})}e(document).on("click","#place_order",function(o){o.preventDefault(),o.stopImmediatePropagation();var t=e("form[name=checkout]");if(t.length<1&&(t=e("#order_review")),t.is(".processing"))return!1;!function(o,r){let c=!1;e(".woocommerce-NoticeGroup").remove(),o.find(".validate-required").each(function(n,t){let i=e(t).find("input"),s=i.attr("type"),l=i.val();switch(s){case"checkbox":c=!i.is(":checked");break;case"text":c=l.length<1}if(!0===c)return a(o),r(c,i),!1}),!1===c&&r(!1,null)}(t,function(o,a){if(!0===o){let e=function(e){let o,r=e.split("_");for(o=0;o<r.length;o++)r[o]=r[o].charAt(0).toUpperCase()+r[o].slice(1);return r.join(" ")}(a.attr("name"))+" is a required field.",o=r.clone();return o.append('<ul class="woocommerce-error" role="alert"></ul>'),o.find("ul").append("<li>"+e+"</li>"),t.prepend(o),!1}if(e("input[name=payment_method]:checked").val()===youcan_pay_script_vars.gateway)return!0==(parseInt(youcan_pay_script_vars.is_pre_order)===parseInt(youcan_pay_script_vars.order_actions.pre_order))?c(t,{token_transaction:youcan_pay_script_vars.token_transaction,redirect:youcan_pay_script_vars.redirect}):n(t),!0;t.submit()})})});