window.ycPay=null,window.setupYouCanPayForm=()=>{try{null==window.ycPay&&(window.ycPay=new YCPay(youcan_pay_script_vars.key,{locale:youcan_pay_script_vars.locale,isSandbox:1===parseInt(youcan_pay_script_vars.is_test_mode),formContainer:"#payment-card",customCSS:".gateway-selector{max-width:unset;}",integrator:"youcanpay-woocommerce"}),window.ycPay.renderAvailableGateways())}catch(e){console.error(e)}},jQuery((function(e){var o=e('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout"></div>');function a(o,a){let r=".woocommerce";null!==window.ycPay&&2===parseInt(window.ycPay.selectedGateway)&&(r=".wc_payment_methods"),e("html, body").animate({scrollTop:e(r).offset().top},400),e(".blockOverlay").remove(),e(".woocommerce-notices-wrapper").remove(),o.removeClass("processing"),null!=a&&(clearInterval(a),e(".woocommerce-NoticeGroup-checkout").remove())}function r(e,o){if(void 0!==o.token_transaction){var r=null;try{r=setInterval((function(){jQuery("#ycp-3ds-modal").length>0&&a(e,r)}),500),window.ycPay.pay(o.token_transaction).then((function({response:t}){if(a(e,r),void 0!==o.redirect){let e=new URL(o.redirect);e.searchParams.set("transaction_id",t.transaction_id),2===parseInt(window.ycPay.selectedGateway)&&e.searchParams.set("gateway","cash_plus"),window.location.href=e.href}})).catch((function({errorMessage:o}){a(e,r),t(e,o)}))}catch(o){a(e,r),console.error(o)}}a(e)}function t(e,a){(null===a||a.length<1)&&(a=youcan_pay_script_vars.errors.connexion_api);let r=o.clone();r.append('<ul class="woocommerce-error" role="alert"></ul>'),r.find("ul").append("<li>"+a+"</li>"),e.prepend(r)}e(document).on("click","#place_order",(function(n){n.preventDefault(),n.stopImmediatePropagation();var c=e("form[name=checkout]");if(c.length<1&&(c=e("#order_review")),c.is(".processing"))return!1;!function(o,r){let t=!1;e(".woocommerce-NoticeGroup").remove();let n=e("input[name=payment_method]:checked").val();if(!youcan_pay_script_vars.gateways.includes(n))return r(!1,null),!1;o.find(".validate-required").each((function(n,c){let i=e(c).find("input"),s=i.attr("type"),l=i.val();if(i.is(":visible")){switch(s){case"checkbox":t=!i.is(":checked");break;case"text":t=l.length<1}if(!0===t)return a(o),r(t,i),!1}})),!1===t&&r(!1,null)}(c,(function(n,i){if(!0===n){let e=i.attr("name"),o=youcan_pay_script_vars.inputs[e];"undefined"===o&&(o=function(e){let o,a=e.split("_");for(o=0;o<a.length;o++)a[o]=a[o].charAt(0).toUpperCase()+a[o].slice(1);return a.join(" ")}(e));let a=youcan_pay_script_vars.errors.input_required.replace("%s",o);return t(c,a),!1}if(e("input[name=payment_method]:checked").val()===youcan_pay_script_vars.default_gateway)return 1==(parseInt(youcan_pay_script_vars.is_pre_order)===parseInt(youcan_pay_script_vars.order_actions.pre_order))?r(c,{token_transaction:youcan_pay_script_vars.token_transaction,redirect:youcan_pay_script_vars.redirect}):function(t){e.ajax({method:"POST",url:youcan_pay_script_vars.checkout_url,data:t.serialize(),dataType:"json",beforeSend:function(){try{e(".woocommerce-NoticeGroup-checkout").remove(),t.addClass("processing"),t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}catch(e){console.error(e)}}}).done((function(e){(function(e,a){if(void 0!==a.messages){let r=o.clone();return r.append(a.messages),e.prepend(r),!0}return!1})(t,e)||r(t,e)})).fail((function(e){})).always((function(e){void 0===e.token_transaction&&a(t)}))}(c),!0;c.submit()}))}))}));