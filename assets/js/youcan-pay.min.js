window.ycPay=null,window.setupYouCanPayForm=(()=>{try{null==window.ycPay&&(window.ycPay=new YCPay(youcan_pay_script_vars.key,{locale:youcan_pay_script_vars.locale}),1===parseInt(youcan_pay_script_vars.is_test_mode)&&window.ycPay.setSandboxMode(!0)),window.ycPay.renderAvailableGateways("#payment-card","default")}catch(e){console.error(e)}}),jQuery(function(e){var a={credit_card:1,cash_plus:2},o=e('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout"></div>');function r(o,r){let c=".woocommerce";null!==window.ycPay&&a.cash_plus===parseInt(window.ycPay.selectedGateway)&&(c=".wc_payment_methods"),e("html, body").animate({scrollTop:e(c).offset().top},400),e(".blockOverlay").remove(),e(".woocommerce-notices-wrapper").remove(),o.removeClass("processing"),null!=r&&(clearInterval(r),e(".woocommerce-NoticeGroup-checkout").remove())}function c(e,o){if(void 0!==o.token_transaction){var c=null;try{c=setInterval(function(){jQuery("#ycp-3ds-modal").length>0&&r(e,c)},500),window.ycPay.pay(o.token_transaction).then(function(t){if(r(e,c),void 0!==o.redirect){let e=new URL(o.redirect);e.searchParams.set("transaction_id",t),a.cash_plus===parseInt(window.ycPay.selectedGateway)&&e.searchParams.set("gateway","cash_plus"),window.location.href=e.href}}).catch(function(a){r(e,c),t(e,a)})}catch(a){r(e,c),console.error(a)}}r(e)}function t(e,a){(null===a||a.length<1)&&(a=youcan_pay_script_vars.errors.connexion_api);let r=o.clone();r.append('<ul class="woocommerce-error" role="alert"></ul>'),r.find("ul").append("<li>"+a+"</li>"),e.prepend(r)}function n(a){e.ajax({method:"POST",url:youcan_pay_script_vars.checkout_url,data:a.serialize(),dataType:"json",beforeSend:function(){try{e(".woocommerce-NoticeGroup-checkout").remove(),a.addClass("processing"),a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}catch(e){console.error(e)}}}).done(function(e){(function(e,a){if(void 0!==a.messages){let r=o.clone();return r.append(a.messages),e.prepend(r),!0}return!1})(a,e)||c(a,e)}).fail(function(e){}).always(function(e){void 0===e.token_transaction&&r(a)})}e(document).on("click","#place_order",function(a){a.preventDefault(),a.stopImmediatePropagation();var o=e("form[name=checkout]");if(o.length<1&&(o=e("#order_review")),o.is(".processing"))return!1;!function(a,o){let c=!1;e(".woocommerce-NoticeGroup").remove();let t=e("input[name=payment_method]:checked").val();if(!youcan_pay_script_vars.gateways.includes(t))return o(!1,null),!1;a.find(".validate-required").each(function(t,n){let i=e(n).find("input"),s=i.attr("type"),l=i.val();if(i.is(":visible")){switch(s){case"checkbox":c=!i.is(":checked");break;case"text":c=l.length<1}if(!0===c)return r(a),o(c,i),!1}}),!1===c&&o(!1,null)}(o,function(a,r){if(!0===a){let e=r.attr("name");const a=youcan_pay_script_vars.inputs[e];let c=youcan_pay_script_vars.errors.input_required.replace("%s",a);return t(o,c),!1}if(e("input[name=payment_method]:checked").val()===youcan_pay_script_vars.default_gateway)return!0==(parseInt(youcan_pay_script_vars.is_pre_order)===parseInt(youcan_pay_script_vars.order_actions.pre_order))?c(o,{token_transaction:youcan_pay_script_vars.token_transaction,redirect:youcan_pay_script_vars.redirect}):n(o),!0;o.submit()})})});